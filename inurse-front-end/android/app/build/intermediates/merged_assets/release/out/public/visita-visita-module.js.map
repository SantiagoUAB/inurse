{"version":3,"sources":["./src/app/visita/visita.page.ts","./src/app/visita/visita.page.html","./src/app/class/class.manageErrors.ts","./src/app/visita/visita-routing.module.ts","./src/app/visita/visita.page.scss","./src/app/visita/visita.module.ts"],"names":[],"mappings":"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","file":"visita-visita-module.js","sourcesContent":["import {Component, OnInit} from '@angular/core';\r\nimport {PacientesService} from '../service/pacientes.service';\r\nimport {Router} from '@angular/router';\r\nimport {Visit} from '../class/class.visit';\r\nimport {Patient} from '../class/class.patient';\r\nimport {HttpClient, HttpEvent, HttpEventType} from '@angular/common/http';\r\nimport {ToastController} from '@ionic/angular';\r\nimport {PantallaPrincipalPage} from '../pantalla-principal/pantalla-principal.page';\r\nimport {catchError} from \"rxjs/operators\";\r\nimport {ClassManageErrors} from '../class/class.manageErrors';\r\n\r\n@Component({\r\n  providers: [PantallaPrincipalPage],\r\n  selector: 'app-visita',\r\n  templateUrl: './visita.page.html',\r\n  styleUrls: ['./visita.page.scss'],\r\n})\r\nexport class VisitaPage implements OnInit {\r\n  patient: Patient;\r\n  visit: Visit;\r\n  private idVisita: number;\r\n  private idPaciente: number;\r\n  pacientName: string;\r\n  username: string;\r\n  treatment: string;\r\n  treatmentAux: string;\r\n\r\n  manageErrors: ClassManageErrors;\r\n  progress: number;\r\n\r\n  constructor(private patientSevice: PacientesService,\r\n              private router: Router,\r\n              private httpClient: HttpClient,\r\n              public toastController: ToastController\r\n\r\n  ) {\r\n    this.manageErrors = new ClassManageErrors();\r\n    this.progress = 0;\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.idVisita = this.patientSevice.getIdVisita();\r\n    this.idPaciente = this.patientSevice.getIdPacient();\r\n    this.getVisitaPatientFile();\r\n    this.getDataPatientFile();\r\n    // this.treatmentAux = this.treatment;\r\n  }\r\n\r\n  private getVisitaPatientFile() {\r\n    this.patientSevice.getVisita(this.idVisita).subscribe(data => {\r\n      console.log('En ficha paciente');\r\n      console.log(data);\r\n      this.visit = new Visit(data);\r\n      this.treatment = this.visit['treatment'];\r\n      this.treatmentAux = this.visit['treatment'];\r\n    });\r\n  }\r\n\r\n  private getDataPatientFile() {\r\n    this.patientSevice.getPaciente(this.idPaciente).subscribe(data => {\r\n      console.log('En ficha paciente');\r\n      console.log(data);\r\n      this.patient = new Patient(data);\r\n      this.pacientName = this.patient['firstName'] + ' ' + this.patient['lastName'];\r\n    });\r\n  }\r\n\r\n  async confirmVisit() {\r\n    console.log('Treatment: ' + this.treatment);\r\n    console.log('TreatmentAux: ' + this.treatmentAux);\r\n    if (this.treatment !== this.treatmentAux) {\r\n      // const postData = { treatment: this.treatment };\r\n      const postData = { date: this.visit['data'], treatment: this.treatment, patient: this.idPaciente };\r\n      console.log('enio la visita', postData);\r\n      this.httpClient.post('http://158.109.74.51:55001/appointment/', postData, {\r\n        reportProgress: true,\r\n        observe: 'events'})\r\n        .pipe(\r\n          catchError(this.manageErrors.errorMgmt)\r\n        )\r\n        .subscribe(async (event: HttpEvent<any>) => {\r\n          // console.log(data);\r\n          switch (event.type){\r\n            case HttpEventType.Sent:\r\n              console.log('Request send');\r\n              break;\r\n            case HttpEventType.ResponseHeader:\r\n              console.log('Response header has ben received!', event.headers);\r\n              break;\r\n            case HttpEventType.UploadProgress:\r\n              this.progress = Math.round(event.loaded / event.total * 100);\r\n              console.log(`Progress ... ${this.progress} %`);\r\n              break;\r\n            case HttpEventType.Response:\r\n              console.log('New Appointment created! ', event.body);\r\n              setTimeout(() => {\r\n              this.progress = 0;\r\n            }, 1500);\r\n          }\r\n          // console.log('Visita modificada correctamente');\r\n          this.correctModification();\r\n\r\n          await this.goToFichaPaciente();\r\n        }, error => {\r\n          console.log('No se ha podido modificar la visita');\r\n        });\r\n    }\r\n    else {\r\n      this.errorModification();\r\n      this.goToFichaPaciente();\r\n    }\r\n  }\r\n\r\n\r\n  private goToFichaPaciente() {\r\n    this.router.navigate(['/ficha-paciente'])\r\n      .then(() => {\r\n        window.location.reload();\r\n      });\r\n  }\r\n\r\n  async correctModification() {\r\n    const toast = await this.toastController.create({\r\n      message: 'Cambios aplicados correctamente',\r\n      duration: 2000\r\n    });\r\n    toast.present();\r\n  }\r\n  async errorModification() {\r\n    const toast = await this.toastController.create({\r\n      message: 'No se han aplicado cambios',\r\n      duration: 2000\r\n    });\r\n    toast.present();\r\n  }\r\n\r\n  private progressResponse( event: HttpEvent<any>) {\r\n    switch (event.type){\r\n      case HttpEventType.Sent:\r\n        console.log('Request send');\r\n        break;\r\n      case HttpEventType.ResponseHeader:\r\n        console.log('Response header has ben received!', event.headers);\r\n        break;\r\n      case HttpEventType.UploadProgress:\r\n        this.progress = Math.round(event.loaded / event.total * 100);\r\n        console.log(`Progress ... ${this.progress} %`);\r\n        break;\r\n      case HttpEventType.Response:\r\n        console.log('New Appointment created! ', event.body);\r\n        setTimeout(() => {\r\n          this.progress = 0;\r\n        }, 1500);\r\n    }\r\n  }\r\n}\r\n\r\n","export default \"<ion-header>\\r\\n  <ion-toolbar>\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n<!--      <ion-menu-button></ion-menu-button>-->\\r\\n      <ion-back-button\\r\\n        text='back'\\r\\n        icon=\\\"chevron-back-outline\\\">\\r\\n      </ion-back-button>\\r\\n    </ion-buttons>\\r\\n    <ion-title>Visita</ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content padding>\\r\\n  <ion-progress-bar [value]=\\\"this.progress\\\"  color=\\\"secondary\\\"  *ngIf=\\\"this.progress > 0\\\"></ion-progress-bar>\\r\\n\\r\\n  <ion-list>\\r\\n    <ion-item>\\r\\n      <ion-text>Nombre del paciente:</ion-text>\\r\\n      <ion-label> {{pacientName}} </ion-label>\\r\\n    </ion-item>\\r\\n\\r\\n    <ion-item>\\r\\n      <ion-label position=\\\"floating\\\">Enfermero/a</ion-label>\\r\\n      <ion-input [(ngModel)]=\\\"username\\\"></ion-input>\\r\\n    </ion-item>\\r\\n\\r\\n    <ion-item>\\r\\n      <ion-label position=\\\"floating\\\">Información de la visita</ion-label>\\r\\n      <ion-textarea auto-grow=\\\"true\\\" [(ngModel)]=\\\"treatment\\\"></ion-textarea>\\r\\n    </ion-item>\\r\\n  </ion-list>\\r\\n\\r\\n  <ion-item>\\r\\n    <ion-text>Fecha:</ion-text>\\r\\n    <ion-label> {{this.visit?.data.getDate()}}/{{this.visit?.data.getMonth()}}/{{this.visit?.data.getFullYear()}} </ion-label>\\r\\n  </ion-item>\\r\\n\\r\\n\\r\\n  <br/>\\r\\n\\r\\n  <div padding>\\r\\n    <ion-button expand=\\\"block\\\" shape=\\\"round\\\" (click)=\\\"confirmVisit()\\\" >Confirmar</ion-button>\\r\\n  </div>\\r\\n\\r\\n</ion-content>\\r\\n\";","import {HttpErrorResponse} from \"@angular/common/http\";\r\nimport {throwError} from \"rxjs\";\r\n\r\nexport class ClassManageErrors{\r\n\r\n\r\n  errorMgmt(error: HttpErrorResponse) {\r\n    let errorMessage = '';\r\n    if (error.error instanceof ErrorEvent) {\r\n      // Get client-side error\r\n      errorMessage = error.error.message;\r\n    } else {\r\n      // Get server-side error\r\n      errorMessage = `Error Code: ${error.status}\\nMessage: ${error.message}`;\r\n    }\r\n    console.log(errorMessage);\r\n    return throwError(errorMessage);\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { VisitaPage } from './visita.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: VisitaPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class VisitaPageRoutingModule {}\r\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJ2aXNpdGEucGFnZS5zY3NzIn0= */\";","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { VisitaPageRoutingModule } from './visita-routing.module';\r\n\r\nimport { VisitaPage } from './visita.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    VisitaPageRoutingModule\r\n  ],\r\n  declarations: [VisitaPage]\r\n})\r\nexport class VisitaPageModule {}\r\n"],"sourceRoot":"webpack:///"}