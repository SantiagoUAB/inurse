{"version":3,"sources":["./src/app/add-visita/add-visita.module.ts","./src/app/add-visita/add-visita-routing.module.ts","./src/app/add-visita/add-visita.page.ts","./src/app/add-visita/add-visita.page.html","./src/app/add-visita/add-visita.page.scss"],"names":[],"mappings":"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","file":"add-visita-add-visita-module.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { AddVisitaPageRoutingModule } from './add-visita-routing.module';\r\n\r\nimport { AddVisitaPage } from './add-visita.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    AddVisitaPageRoutingModule\r\n  ],\r\n  declarations: [AddVisitaPage]\r\n})\r\nexport class AddVisitaPageModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { AddVisitaPage } from './add-visita.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: AddVisitaPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class AddVisitaPageRoutingModule {}\r\n","import {Component, OnInit} from '@angular/core';\r\nimport {PacientesService} from '../service/pacientes.service';\r\nimport {Router} from '@angular/router';\r\nimport {Visit} from '../class/class.visit';\r\nimport {Patient} from '../class/class.patient';\r\nimport {HttpClient, HttpEvent, HttpEventType} from '@angular/common/http';\r\nimport {ToastController} from '@ionic/angular';\r\nimport {PantallaPrincipalPage} from '../pantalla-principal/pantalla-principal.page';\r\nimport {catchError} from 'rxjs/operators';\r\nimport {ClassManageHttpClient} from '../class/classManageHttpClient';\r\n\r\n@Component({\r\n  selector: 'app-add-visita',\r\n  templateUrl: './add-visita.page.html',\r\n  styleUrls: ['./add-visita.page.scss'],\r\n})\r\nexport class AddVisitaPage implements OnInit {\r\n  patient: Patient;\r\n  visit: Visit;\r\n  private idVisita: number;\r\n  private idPaciente: number;\r\n  pacientName: string;\r\n  username: string;\r\n  treatment: string;\r\n  treatmentAux: string;\r\n  currentDate: Date;\r\n\r\n  manageErrors: ClassManageHttpClient;\r\n  progress: number;\r\n\r\n  constructor(private patientSevice: PacientesService,\r\n              private router: Router,\r\n              private httpClient: HttpClient,\r\n              public toastController: ToastController\r\n\r\n  ) {\r\n    this.manageErrors = new ClassManageHttpClient();\r\n    this.progress = 0;\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.idVisita = this.patientSevice.getIdVisita();\r\n    this.idPaciente = this.patientSevice.getIdPacient();\r\n    // this.getVisitaPatientFile();\r\n    this.getDataPatientFile();\r\n    this.currentDate = new Date();\r\n    console.log('Data actual: ' + this.currentDate);\r\n    // this.treatmentAux = this.treatment;\r\n  }\r\n\r\n  private getVisitaPatientFile() {\r\n    this.patientSevice.getVisita(this.idVisita).subscribe(data => {\r\n      console.log('En ficha paciente');\r\n      console.log(data);\r\n      this.visit = new Visit(data);\r\n      this.treatment = this.visit['treatment'];\r\n      this.treatmentAux = this.visit['treatment'];\r\n    });\r\n  }\r\n\r\n  private getDataPatientFile() {\r\n    this.patientSevice.getPaciente(this.idPaciente).subscribe(data => {\r\n      console.log('En ficha paciente');\r\n      console.log(data);\r\n      this.patient = new Patient(data);\r\n      this.pacientName = this.patient['firstName'] + ' ' + this.patient['lastName'];\r\n    });\r\n  }\r\n\r\n  async confirmVisit() {\r\n    console.log('Treatment: ' + this.treatment);\r\n    console.log('TreatmentAux: ' + this.treatmentAux);\r\n    if (true)     {\r\n      // const postData = { treatment: this.treatment };\r\n      const postData = { date: this.currentDate, nurse: 2 ,  treatment: this.treatment, patient: this.idPaciente };\r\n\r\n      this.httpClient.post('http://158.109.74.51:55001/appointment/', postData, {\r\n        reportProgress: true,\r\n        observe: 'events'})\r\n        .pipe(\r\n          catchError(this.manageErrors.errorMgmt)\r\n        )\r\n        .subscribe(async (event: HttpEvent<any>) => {\r\n          // console.log(data);\r\n          console.log('enio la visita', postData);\r\n          switch (event.type){\r\n            case HttpEventType.Sent:\r\n              console.log('Request send');\r\n              break;\r\n            case HttpEventType.ResponseHeader:\r\n              console.log('Response header has ben received!', event.headers);\r\n              break;\r\n            case HttpEventType.UploadProgress:\r\n              this.progress = Math.round(event.loaded / event.total * 100);\r\n              console.log(`Progress ... ${this.progress} %`);\r\n              break;\r\n            case HttpEventType.Response:\r\n              console.log('New Appointment created! ', event.body);\r\n              await this.goToFichaPaciente();\r\n\r\n              setTimeout(() => {\r\n                this.progress = 0;\r\n              }, 1500);\r\n          }\r\n          // console.log('Visita modificada correctamente');\r\n\r\n\r\n\r\n        }, error => {\r\n          console.log('No se ha podido modificar la visita');\r\n        });\r\n    }\r\n    else {\r\n      this.errorModification();\r\n      this.goToFichaPaciente();\r\n    }\r\n  }\r\n\r\n\r\n  private goToFichaPaciente() {\r\n    this.router.navigate(['/pantalla-principal'])\r\n      .then(() => {\r\n        window.location.reload();\r\n        this.correctModification();\r\n      });\r\n  }\r\n\r\n  async correctModification() {\r\n    const toast = await this.toastController.create({\r\n      message: 'Cambios aplicados correctamente',\r\n      duration: 2000\r\n    });\r\n    toast.present();\r\n  }\r\n  async errorModification() {\r\n    const toast = await this.toastController.create({\r\n      message: 'No se han aplicado cambios',\r\n      duration: 2000\r\n    });\r\n    toast.present();\r\n  }\r\n\r\n  private progressResponse( event: HttpEvent<any>) {\r\n    switch (event.type){\r\n      case HttpEventType.Sent:\r\n        console.log('Request send');\r\n        break;\r\n      case HttpEventType.ResponseHeader:\r\n        console.log('Response header has ben received!', event.headers);\r\n        break;\r\n      case HttpEventType.UploadProgress:\r\n        this.progress = Math.round(event.loaded / event.total * 100);\r\n        console.log(`Progress ... ${this.progress} %`);\r\n        break;\r\n      case HttpEventType.Response:\r\n        console.log('New Appointment created! ', event.body);\r\n        setTimeout(() => {\r\n          this.progress = 0;\r\n        }, 1500);\r\n    }\r\n  }\r\n}\r\n","export default \"<ion-header>\\r\\n  <ion-toolbar>\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <!--      <ion-menu-button></ion-menu-button>-->\\r\\n      <ion-back-button\\r\\n        text='back'\\r\\n        icon=\\\"chevron-back-outline\\\">\\r\\n      </ion-back-button>\\r\\n    </ion-buttons>\\r\\n    <ion-title>Visita</ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content padding>\\r\\n  <ion-progress-bar [value]=\\\"this.progress\\\"  color=\\\"secondary\\\"  *ngIf=\\\"this.progress > 0\\\"></ion-progress-bar>\\r\\n\\r\\n  <ion-list>\\r\\n    <ion-item>\\r\\n      <ion-text>Nombre del paciente:</ion-text>\\r\\n      &nbsp;\\r\\n      <ion-label> {{pacientName}} </ion-label>\\r\\n    </ion-item>\\r\\n    <ion-item>\\r\\n      <ion-label position=\\\"floating\\\">Información de la visita</ion-label>\\r\\n      &nbsp;\\r\\n      <ion-textarea auto-grow=\\\"true\\\" [(ngModel)]=\\\"treatment\\\"></ion-textarea>\\r\\n    </ion-item>\\r\\n  </ion-list>\\r\\n\\r\\n  <ion-item>\\r\\n    <ion-text>Fecha:</ion-text>\\r\\n    &nbsp;\\r\\n    <ion-label> {{this.currentDate.getDate()}}/{{this.currentDate.getMonth()}}/{{this.currentDate.getFullYear()}} </ion-label>\\r\\n  </ion-item>\\r\\n\\r\\n\\r\\n  <br/>\\r\\n\\r\\n  <div padding>\\r\\n    <ion-button expand=\\\"block\\\" shape=\\\"round\\\" (click)=\\\"confirmVisit()\\\" >Confirmar</ion-button>\\r\\n  </div>\\r\\n\\r\\n</ion-content>\\r\\n\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJhZGQtdmlzaXRhLnBhZ2Uuc2NzcyJ9 */\";"],"sourceRoot":"webpack:///"}